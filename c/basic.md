# 基础

## 函数

函数封装了程序的实现细节，通过函数调用，代码更加易用清晰。

## 参数—传值调用

C 语言中所有函数参数都是通过值传递的。传递给被调用函数的参数值存放在临时变量中，而不是存放于原来的变量。

需要注意，值传递与能否改变原始参数的值是无关的，因此，在 C 语言中：

- 一般变量参数：不能修改原始参数值，只能修改该变量临时创建的私有副本的值。

- 指针变量参数：通过变量的地址，间接修改原始参数值。指针本身仍然会复制。

- 数组参数：数组名作参数，实际传递的是数组起始元素地址，效果等同指针变量，数组本身不会被复制。

## 程序结构

C 是一种面向过程的结构化编程语言，Pascal 之父说程序=算法+数据结构，在 C 语言中，程序可以看成由一系列的外部对象构成，外部对象包括：

- 外部变量：在函数外面定义的变量，可以被多个函数使用。
- 函数：由于 C 语言不允许在函数中定义函数，因此函数本身就是外部的。

默认情况下，外部变量和函数拥有如下性质：通过同一个名字对外部变量的所有引用，实际上都是引用同一个对象。也称为外部链接性质。

### 作用域规则

名字的作用域是指：程序中可以使用该名字的区域。

外部变量和函数的作用域为：

- 从声明处开始
- 到其所在的待编译文件末尾结束。

函数内部的变量是该函数的私有变量，或者称之为局部变量，其作用域为该函数。

### 外部变量

外部变量可以在全局范围内访问，因此外部变量可以作为函数之间交互的桥梁，可以简化函数参数表设计。但需要注意这种方式不能被滥用，因为这导致各个函数具有太多数据关联。

外部变量的声明与定义是完全不同的：

- 变量声明用于说明变量的属性（主要是类型）
- 变量定义除此之外将会引起存储器的内存分配。

外部变量定义如下，这两条语句将会引起存储分配，并且可作为该源文件中其余部分的声明。 

```c
int sp;
double val[MAXVAL];
```

外部变量声明如下，如果要在外部变量定义前就使用该文件，或者变量的使用和定义不在同一个源文件中，则必须使用 `extern` 关键字。 

```c
extern int sp;
extern double val[];
```

在一个源程序的所有文件中，**外部变量只能在某个文件中被定义一次**，而其他文件通过 `extern` 声明来访问它（定义该变量的文件也可以包含该变量的 `extern` 声明）。

外部变量的初始化只能出现在定义中，未初始化的外部变量默认值为 0。

### 局部变量

与外部变量相对的，局部变量是在函数内定义的变量，包括两种变量：

- 自动变量：仅在函数调用时存在，函数执行完毕退出时消失。大多数局部变量，通常都是自动变量。
- 静态局部变量：通过 `static` 关键字限制的局部变量，不随函数调用而存亡，而是一直存在。

### 静态变量

静态对象是指通过 `static` 限制的外部对象，包括静态变量和静态函数，其**作用域被限制在被编译源文件中**。通过 `static` 限制对象可以达到隐藏外部对象的目的。

静态变量/静态函数与外部变量/函数类似，但名字仅能在当前源文件访问，不会污染全局命名空间，通过静态变量或静态函数，将调用者不关心的外部对象隐藏到文件内部，可以达到模块化编程的效果。

局部变量也可以用 `static` 关键字修饰，其效果是：该变量只能在某个特定函数中使用，但却一直占据存储空间，不随函数的调用退出而产生消失。 

### 变量类型总结

各种类型的变量对比如下。

|   变量类型   | 定义位置 | 声明修饰符 | 初始值 |   作用域   |     生存期     |
| :----------: | :------: | :--------: | :----: | :--------: | :------------: |
|   外部变量   | 函数外部 |  `extern`  |   0    |    全局    |    一直存在    |
|   静态变量   | 函数外部 |  `static`  |   0    | 所在源文件 |    一直存在    |
|   自动变量   | 函数内部 |     无     |  随机  |  所在函数  | 随函数调用存亡 |
| 静态局部变量 | 函数内部 |  `static`  |   0    |  所在函数  |    一直存在    |

### 头文件组织

对于许多高级程序语言来说，整个程序范围太大，而函数范围太小，因此使用模块或包的概念表示一类变量和函数的集合，从而便于组织程序架构。例如 Java 中的类和包，Python 中的模块和包等概念。 

然而，C 语言并没有这些概念，并且由于 C 支持分离编译，程序员可以将一个程序的各个部分分散到不同的源文件中编译，然后链接到一起。这使得编写大型程序更加难以控制，借助于 `static` 静态对象机制，可以实现基于文件的模块化编程，但是当某个源文件内容过多时，又会使得开发不便。

因此，C 语言并没有一种万能的模块化编程范式，程序架构的依赖于开发者控制，需要开发者精心的组织头文件。一般而言，可以按照如下方式组织头文件：

- 对于中等规模的程序：最好只用一个头文件存放程序中各部分共享的对象。
- 较大规模的程序：每个 `.c` 文件对应一个 `.h` 文件，每一对作为一个逻辑上的模块对内对外提供接口。

## C 预处理器

### 文件包含

```c
#include <filename>
#include "filename"
```

### 宏定义

```c
#define IDENTIFIER TEXT
#define IDENTIFIER(OPT) TEXT
#undef IDENTIFIER
```

### 条件编译

### OS 特定编译功能

## 标准库

