# IP 路由 - IS-IS 协议

## IS-IS 简介

IS-IS（Intermediate System to Intermediate System）属于内部网关协议，是一种链路状态协议，使用最短路径优先算法进行路由计算。IS-IS 协议最初是由 ISO 为其 CLNP 网络设计的动态路由协议，但随着 TCP/IP 协议栈的流行，为了提供对 IP 网络的支持，IETF 对其进行了扩充，使之能够同时应用在 TCP/IP 和 OSI 中，称为集成 IS-IS。

## IS-IS 基本概念

为了支持大规模的路由网络，IS-IS 自治系统内采用了域的概念，每个路由器都只属于一个区域。物理上整个网络由多个独立的域组成，而逻辑上整个网络形成**骨干区域**与**非骨干区域**两级的分层结构。

根据所属区域及功能，IS-IS 路由器分为三种类型：

- Level-1路由器：部署在非骨干区域，负责区域内路由。
- Level-2路由器：部署在骨干区域，负责区域间的路由。
- Level-1-2路由器：部署在骨干区域，负责非骨干区域与骨干区域相连。

【图】

具体而言：

| 路由器分类       | 可建立邻居类型                                               | 功能                                                         |
| ---------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| Level-1路由器    | 同一区域的 Level-1 和 Level-1-2 路由器                       | 负责维护本区域 Level-1 的 LSDB，到本区域外的报文转发给最近的 Level-1-2 路由器。 |
| Level-2路由器    | 同一或者不同区域的 Level-2 路由器、其它区域的 Level-1-2 路由器 | 负责不同区域间通信                                           |
| Level-1-2 路由器 | 与同一区域的 Level-1 和 Level-1-2 路由器形成 Level-1 邻居关系；<br>与其他区域的 Level-2 和 Level-1-2 路由器形成Level-2 邻居关系。 | Level-1-2 路由器维护两个 LSDB，Level-1 的 LSDB 用于区域内路由，Level-2 的 LSDB 用于区域间路由。 |

IS-IS 只支持两种类型的网络，根据物理链路不同可分为：

- 广播链路：如 Ethernet、Token-Ring 等。
- 点到点链路：如 PPP、HDLC 等。

## IS-IS 基本原理

IS-IS 是一种链路状态路由协议，每一台路由器都会生成一个 LSP，它包含了该路由器所有使能 IS-IS 协议接口的链路状态信息。通过跟相邻设备建立 IS-IS 邻接关系，互相更新本地设备的 LSDB，可以使得 LSDB 与整个 IS-IS 网络的其他设备的 LSDB 实现同步。然后根据 LSDB 运用 SPF 算法计算出 IS-IS 路由。如果此 IS-IS 路由是到目的地址的最优路由，则此路由会下发到 IP 路由表中，并指导报文的转发。
